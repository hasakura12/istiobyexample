<!doctype html><html><head><meta charset=utf-8><title>JWT&nbsp;&ndash;&nbsp;Istio By Example (ja)</title><link href="https://fonts.googleapis.com/css?family=Chivo|Fira+Code|Noto+Sans&display=swap" rel=stylesheet><link rel="shortcut icon" href=../images/spider-web.png><link rel=stylesheet href=https://istiobyexample-ja.github.io/istiobyexample/css/core.min.1ec2f555efc6ec0b36a9bbdf72319cf586f948899f24ab0ef5c93c82bbc7987b1eb704efe0b3a4dad22677058a40e6f6.css integrity=sha384-HsL1Ve/G7As2qbvfcjGc9Yb5SImfJKsO9ck8grvHmHsetwTv4LOk2tImdwWKQOb2><meta name=generator content="Hugo 0.64.0"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=color-scheme content="light only"><meta name=supported-color-schemes content="light only"><meta property="og:title" content="JWT"><meta property="og:description" content="JSON Web Token（JWT）は、サーバーアプリケーションでユーザーを識別するために使用される認証トークンの一種です。JWTにはクライアントの呼び"><meta property="og:type" content="article"><meta property="og:url" content="https://istiobyexample-ja.github.io/istiobyexample/jwt/"><meta property="og:image" content="https://istiobyexample-ja.github.io/istiobyexample/images/opengraph.png"><meta property="article:published_time" content="2019-12-31T00:00:00+00:00"><meta property="article:modified_time" content="2020-04-05T18:10:01+09:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://istiobyexample-ja.github.io/istiobyexample/images/opengraph.png"><meta name=twitter:title content="JWT"><meta name=twitter:description content="JSON Web Token（JWT）は、サーバーアプリケーションでユーザーを識別するために使用される認証トークンの一種です。JWTにはクライアントの呼び"></head><body><div class="base-body max-width"><section id=header class="header max-body-width"><p><a class=home href=../><img class=site-logo src=../images/istio-logo.png alt>
<span class=site-name>Istio By Example</span></a></p><p>本サイトは <a href=https://istiobyexample.dev>Istio By Example</a> の和訳です</p></section><div id=content class="flex-body max-body-width"><section class=article-header><h1 class=article-title>JWT</h1></section><div class=flex-body><article class=markdown-body><p><a href=https://jwt.io/introduction/ target=_blank>JSON Web Token</a>（JWT）は、サーバーアプリケーションでユーザーを識別するために使用される認証トークンの一種です。JWTにはクライアントの呼び出し元に関する情報が含まれており、クライアントセッションアーキテクチャの一部として使用できます。<a href=https://auth0.com/docs/tokens/concepts/jwks target=_blank>JSON Web Key Set</a>（JWKS）には、受信するJWTの検証に使用される暗号化キーが含まれています。</p><p>Istioの<a href=https://istio.io/docs/reference/config/security/istio.authentication.v1alpha1/#Jwt target=_blank>認証API</a>を使用して、サービスの<a href=https://istio.io/docs/concepts/security/#origin-authentication target=_blank>JWTポリシーを構成</a>できます。</p><p><a target=_blank rel="noopener noreferrer" href=../images/jwt.png><img class=img src=../images/jwt.png alt=jwt></a></p><p>この例では、ホームページ（ <code>/</code> ）とPodヘルスチェック（ <code>/_healthz</code> ）を除く、すべての <code>frontend</code> サービスのルートにJWTが必要です。</p><p>Istioポリシーで、frontendのサイドカープロキシにマウントされるテスト公開鍵（ <code>jwksUri</code> ）へのパスを指定します。認証されていないリクエストはすべて、Envoyから <code>401-Unauthorized</code> ステータスを受け取ります。</p><div class=highlight><pre class=chroma><code class=language-YAML data-lang=YAML><span class=k>apiVersion</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;authentication.istio.io/v1alpha1&#34;</span><span class=w>
</span><span class=w></span><span class=k>kind</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Policy&#34;</span><span class=w>
</span><span class=w></span><span class=k>metadata</span><span class=p>:</span><span class=w>
</span><span class=w></span><span class=w>  </span><span class=k>name</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;frontend-jwt&#34;</span><span class=w>
</span><span class=w></span><span class=k>spec</span><span class=p>:</span><span class=w>
</span><span class=w></span><span class=w>  </span><span class=k>targets</span><span class=p>:</span><span class=w>
</span><span class=w></span><span class=w>  </span>- <span class=k>name</span><span class=p>:</span><span class=w> </span>frontend<span class=w>
</span><span class=w>  </span><span class=k>origins</span><span class=p>:</span><span class=w>
</span><span class=w></span><span class=w>  </span>- <span class=k>jwt</span><span class=p>:</span><span class=w>
</span><span class=w></span><span class=w>      </span><span class=k>issuer</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;testing@secure.istio.io&#34;</span><span class=w>
</span><span class=w>      </span><span class=k>jwksUri</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;https://raw.githubusercontent.com/istio/istio/release-1.2/security/tools/jwt/samples/jwks.json&#34;</span><span class=w>
</span><span class=w>      </span><span class=k>trigger_rules</span><span class=p>:</span><span class=w>
</span><span class=w></span><span class=w>      </span>- <span class=k>excluded_paths</span><span class=p>:</span><span class=w>
</span><span class=w></span><span class=w>        </span>- <span class=k>exact</span><span class=p>:</span><span class=w> </span>/_healthz<span class=w>
</span><span class=w>        </span>- <span class=k>exact</span><span class=p>:</span><span class=w> </span>/<span class=w>
</span><span class=w>  </span><span class=k>principalBinding</span><span class=p>:</span><span class=w> </span>USE_ORIGIN<span class=w>
</span></code></pre></div><p>詳細とインタラクティブな例を試すには、<a href=https://istio.io/docs/tasks/security/authentication/authn-policy/#end-user-authentication target=_blank>Istio ドキュメント</a>と<a href=https://github.com/GoogleCloudPlatform/istio-samples/tree/master/security-intro#add-end-user-jwt-authentication target=_blank>istio-samples リポジトリ</a>をご覧ください。</p></article></div><section id=footer class=footer><p>Made with ❤️ by <a href=https://twitter.com/askmeegs>Megan O'Keefe</a> | <a href=https://github.com/askmeegs/istiobyexample>Source</a> | <a href=https://github.com/cntrump/hugo-notepadium>Theme</a></p><p>Localized by <a href=https://github.com/istiobyexample-ja/istiobyexample>Istio by Example-ja Project</a></p></section></div></div></body></html>